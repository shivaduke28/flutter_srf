# Product Requirements Document (PRD)

このdocではFlutter SRFのプロダクト要件を定義します。

## 概要

Flutter SRFは、音源ファイルを独自のSRF形式で管理するmacOS向けの音楽ライブラリアプリケーションです。

### 主な特徴
- macOS/Windows/Linuxでビルド可能（現在はmacOSに注力）
- 音源ファイル（MP3）を専用のライブラリディレクトリにSRF形式でコピーして管理
- メタデータの自動抽出と管理
- シンプルで使いやすいUI

### 技術スタック
- Flutter 3.x
- Riverpod + Hooks + Freezed
- flutter_media_metadata（メタデータ抽出）
- path_provider（ファイルシステムアクセス）
- url_launcher（システムファイルエクスプローラー連携）

## 機能要件

### 実装済み機能

#### 1. ライブラリ管理
- ✅ アプリケーションサポートディレクトリ内に専用のライブラリディレクトリを作成
- ✅ ライブラリパスの自動設定（~/Library/Application Support/flutter_srf/library）
- ✅ Finderでライブラリディレクトリを開く機能

#### 2. インポート機能
- ✅ ディレクトリを選択してMP3ファイルを一括インポート
- ✅ メタデータ（タイトル、アーティスト、アルバム、再生時間等）の自動抽出
- ✅ SRFコンテナ形式での保存
- ✅ インポート進捗表示
- ✅ ネイティブのファイル選択ダイアログ使用

#### 3. 楽曲一覧画面
- ✅ ライブラリ内の全楽曲を表示
- ✅ 楽曲情報（タイトル、アーティスト、アルバム、再生時間）の表示
- ✅ リアルタイム検索機能（タイトル、アーティスト、アルバムで検索）
- ✅ ソート機能（タイトル、アーティスト、追加日）
- ✅ プルトゥリフレッシュ機能

#### 4. 設定画面
- ✅ ライブラリパスの表示
- ✅ サポートされる拡張子の表示（現在は.mp3のみ）

#### 5. 楽曲再生機能
- ✅ 内蔵プレイヤーでの再生（just_audio使用）
- ✅ 再生コントロール（再生/一時停止/停止）
- ✅ 再生中の楽曲のハイライト表示
- ✅ プレイヤーコントロールバー（楽曲情報、進捗表示）
- ✅ 音量調整機能（スライダーで0.0〜1.0の範囲）

#### 6. アーティスト一覧画面
- ✅ アーティストのグループ化表示
- ✅ アーティスト選択時のアルバムごとの楽曲表示
- ✅ アーティストごとの楽曲数・アルバム数表示
- ✅ アーティスト詳細画面から楽曲再生可能

#### 7. アルバム一覧画面
- ✅ アルバムのグリッド表示
- ✅ アルバム選択時の楽曲一覧表示
- ✅ アルバムごとの楽曲数・年表示
- ✅ アルバム詳細画面から楽曲再生可能
- ❌ アルバムアートワークの表示（未実装）

### 未実装機能

#### 1. メタデータ編集
- 楽曲情報の手動編集
- 一括編集機能

#### 2. 高度な再生機能
- シーク機能（楽曲内の任意の位置への移動）
- プレイリスト機能
- リピート・シャッフル再生
- 次へ/前へボタン

#### 3. データ永続化
- ライブラリ情報のデータベース保存
- 再生履歴の記録
- お気に入り機能
- 音量設定の永続化

## UI/UX設計

### ナビゲーション
- タブベースのナビゲーション（楽曲、アーティスト、アルバム、設定）
- 各タブは独立したビューとして動作

### デザイン原則
- Material Design 3準拠
- シンプルで直感的な操作
- レスポンシブデザイン

## 技術仕様

### データ永続化
- 現在：メモリ内での一時的な管理
- 将来：SQLiteまたはHiveでのローカルDB実装予定

### ファイル管理
- SRFコンテナ：ディレクトリベースの管理
- メタデータ：JSON形式（meta.json）
- 音源ファイル：元のファイルをコピーして保存

### セキュリティ
- macOSサンドボックス対応
- ファイルアクセス権限の適切な管理

## 今後の拡張予定

1. **マルチプラットフォーム対応**
   - Windows/Linux向けの最適化
   - モバイル版（iOS/Android）の検討

2. **高度な機能**
   - プレイリスト管理
   - スマートプレイリスト
   - 音楽ファイルのタグ編集
   - アルバムアートワークの管理

3. **同期機能**
   - クラウドストレージとの連携
   - 複数デバイス間での同期